-- MySQL Script generated by MySQL Workbench
-- Sun Mar 18 21:27:59 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema fad
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema fad
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `fad` DEFAULT CHARACTER SET utf8 ;
USE `fad` ;

-- -----------------------------------------------------
-- Table `fad`.`TN_USER_PROFILE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_USER_PROFILE` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CN_NAME` VARCHAR(20) NULL COMMENT '用户姓名',
  `CN_NICK_NAME` VARCHAR(20) NULL COMMENT '昵称',
  `CN_INVITE_CODE` VARCHAR(15) NULL COMMENT '邀请码',
  `CN_REGISTER_TIME` BIGINT NULL COMMENT '注册时间',
  `CN_HOME_PAGE` VARCHAR(300) NULL COMMENT '主页地址',
  `CN_HEAD_IMG` VARCHAR(300) NULL COMMENT '头像URI',
  `CN_REMARK` VARCHAR(500) NULL COMMENT '个人签名',
  PRIMARY KEY (`CN_ID`),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC))
ENGINE = InnoDB
COMMENT = '用户个人信息表';


-- -----------------------------------------------------
-- Table `fad`.`TN_USER`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_USER` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CN_LOGIN_NAME` VARCHAR(45) NULL COMMENT '登录帐号,可以为空,一旦有数据则不可以修改',
  `CN_EMAIL` VARCHAR(128) NULL COMMENT '电子邮箱',
  `CN_MOBILE_NO` VARCHAR(11) NULL COMMENT '电话号码',
  `CN_PASSWORD` VARCHAR(45) NULL COMMENT '密码,MD5加密',
  `CR_USER_PROFILE_ID` VARCHAR(32) NOT NULL,
  `CR_ACTIVE_FLAG` VARCHAR(45) NOT NULL COMMENT '关联道TL_BOOLEAN表,活动标识,默认为是.',
  PRIMARY KEY (`CN_ID`),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  INDEX `fk_TN_USER_TN_USER_PROFILE1_idx` (`CR_USER_PROFILE_ID` ASC),
  CONSTRAINT `fk_TN_USER_TN_USER_PROFILE1`
    FOREIGN KEY (`CR_USER_PROFILE_ID`)
    REFERENCES `fad`.`TN_USER_PROFILE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '网站的普通用户表';


-- -----------------------------------------------------
-- Table `fad`.`TN_USER_C`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_USER_C` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NULL COMMENT '关联的普通帐号',
  `CN_NO` VARCHAR(45) NULL COMMENT '工号',
  `CN_NAME` VARCHAR(45) NULL COMMENT '姓名',
  `CN_LOGIN_NAME` VARCHAR(45) NULL COMMENT '登录帐号',
  `CN_PASSWORD` VARCHAR(45) NULL COMMENT '密码,MD5加密',
  `CR_SUPPER_FLAG` VARCHAR(32) NULL COMMENT '关联道TL_BOOLEAN表,超级管理员标识,默认为否.',
  `CR_ACTIVE_FLAG` VARCHAR(32) NULL COMMENT '关联道TL_BOOLEAN表,活动标识,默认为是.',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_USER_C_TN_USER_idx` (`CR_USER_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_USER_C_TN_USER`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '系统管理员表,用户管理员登录.';


-- -----------------------------------------------------
-- Table `fad`.`TN_PASSWORD_LOG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_PASSWORD_LOG` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL,
  `CN_PASSWORD` VARCHAR(45) NULL COMMENT '密码',
  `CN_TIME` BIGINT NULL COMMENT '密码生成的时间',
  `CN_IP` VARCHAR(45) NULL COMMENT '修改密码时,用户的IP地址',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_PASSWORD_LOG_TN_USER1_idx` (`CR_USER_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_PASSWORD_LOG_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '修改密码的历史记录';


-- -----------------------------------------------------
-- Table `fad`.`TN_LOGIN_LOG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_LOGIN_LOG` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL COMMENT '登录的用户',
  `CN_TIME` BIGINT NULL COMMENT '登录的时间',
  `CN_IP` VARCHAR(45) NULL COMMENT '登录的IP',
  `CN_ADDRESS` VARCHAR(150) NULL COMMENT '登录的地址',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_LOGIN_LOG_TN_USER1_idx` (`CR_USER_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_LOGIN_LOG_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '用户登录的日志';


-- -----------------------------------------------------
-- Table `fad`.`TN_SPITTLE_TYPE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_SPITTLE_TYPE` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CN_NO` VARCHAR(128) NULL COMMENT '编码,主要用于排序',
  `CN_NAME` VARCHAR(45) NULL COMMENT '类别名称',
  PRIMARY KEY (`CN_ID`),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC))
ENGINE = InnoDB
COMMENT = '文章类别';


-- -----------------------------------------------------
-- Table `fad`.`TN_SPITTLE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_SPITTLE` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL COMMENT '发帖人',
  `CR_SPITTLE_TYPE_ID` VARCHAR(32) NOT NULL COMMENT '当前文章的类别',
  `CN_TITLE` VARCHAR(100) NOT NULL COMMENT '标题',
  `CN_CONTENT` LONGTEXT NULL COMMENT '内容',
  `CN_TIME` BIGINT NULL COMMENT '创建时间',
  `CN_VIEW_COUNT` BIGINT NULL COMMENT '阅读数',
  `CN_ADMIRE_COUNT` BIGINT NULL COMMENT '赞赏数',
  `CR_ACTIVE_FLAG` VARCHAR(32) NULL COMMENT '关联道TL_BOOLEAN表,标识当前文章是否可见,默认为是.',
  `CR_AUTHORIZED_FLAG` VARCHAR(32) NULL COMMENT '关联道TL_BOOLEAN表,标识当前文章是否已经核准,默认为否.',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_SPITTLE_TN_USER1_idx` (`CR_USER_ID` ASC),
  INDEX `fk_TN_SPITTLE_TN_SPITTLE_TYPE1_idx` (`CR_SPITTLE_TYPE_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_SPITTLE_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TN_SPITTLE_TN_SPITTLE_TYPE1`
    FOREIGN KEY (`CR_SPITTLE_TYPE_ID`)
    REFERENCES `fad`.`TN_SPITTLE_TYPE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '文章';


-- -----------------------------------------------------
-- Table `fad`.`TN_SPITTLE_FOLLOW`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_SPITTLE_FOLLOW` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_SPITTLE_ID` VARCHAR(32) NOT NULL COMMENT '回复的文章',
  `CR_USER_ID` VARCHAR(32) NOT NULL COMMENT '发帖人',
  `CN_CONTENT` VARCHAR(5000) NULL COMMENT '内容',
  `CN_TIME` BIGINT NULL COMMENT '创建时间',
  `CN_ADMIRE_COUNT` BIGINT NULL COMMENT '赞赏数',
  `CR_PARENT_ID` VARCHAR(32) NULL COMMENT '自身管理,记录针对跟帖的回复.',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_SPITTLE_TN_USER1_idx` (`CR_USER_ID` ASC),
  INDEX `fk_TN_SPITTLE_FOLLOW_TN_SPITTLE1_idx` (`CR_SPITTLE_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_SPITTLE_TN_USER10`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TN_SPITTLE_FOLLOW_TN_SPITTLE1`
    FOREIGN KEY (`CR_SPITTLE_ID`)
    REFERENCES `fad`.`TN_SPITTLE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '跟帖';


-- -----------------------------------------------------
-- Table `fad`.`TN_SPITTLE_LOG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_SPITTLE_LOG` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL,
  `CR_SPITTLE_ID` VARCHAR(32) NOT NULL,
  `CN_TIME` BIGINT NULL,
  `CN_CONTENT` LONGTEXT NULL COMMENT '只有最近的5次的修改内容记录超过则清空之前的内容.',
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_SPITTLE_LOG_TN_USER1_idx` (`CR_USER_ID` ASC),
  INDEX `fk_TN_SPITTLE_LOG_TN_SPITTLE1_idx` (`CR_SPITTLE_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_SPITTLE_LOG_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TN_SPITTLE_LOG_TN_SPITTLE1`
    FOREIGN KEY (`CR_SPITTLE_ID`)
    REFERENCES `fad`.`TN_SPITTLE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '文章的修改日志';


-- -----------------------------------------------------
-- Table `fad`.`TL_BOOLEAN`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TL_BOOLEAN` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CN_NO` VARCHAR(128) NULL COMMENT '编码.主要用于排序',
  `CN_NAME` VARCHAR(10) NULL,
  PRIMARY KEY (`CN_ID`),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC))
ENGINE = InnoDB
COMMENT = '布尔表,记录 是和否';


-- -----------------------------------------------------
-- Table `fad`.`TN_USER_VIEW_SPITTLE_LOG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_USER_VIEW_SPITTLE_LOG` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL,
  `CR_SPITTLE_ID` VARCHAR(32) NOT NULL,
  `CN_TIME` BIGINT NULL,
  PRIMARY KEY (`CN_ID`),
  INDEX `fk_TN_USER_VIEW_SPITTLE_LOG_TN_USER1_idx` (`CR_USER_ID` ASC),
  INDEX `fk_TN_USER_VIEW_SPITTLE_LOG_TN_SPITTLE1_idx` (`CR_SPITTLE_ID` ASC),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  CONSTRAINT `fk_TN_USER_VIEW_SPITTLE_LOG_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TN_USER_VIEW_SPITTLE_LOG_TN_SPITTLE1`
    FOREIGN KEY (`CR_SPITTLE_ID`)
    REFERENCES `fad`.`TN_SPITTLE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '用户文章的阅读日志';


-- -----------------------------------------------------
-- Table `fad`.`TN_USER_ADMIRE_SPITTLE_LOG`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `fad`.`TN_USER_ADMIRE_SPITTLE_LOG` (
  `CN_ID` VARCHAR(32) NOT NULL,
  `CR_USER_ID` VARCHAR(32) NOT NULL,
  `CR_SPITTLE_ID` VARCHAR(32) NOT NULL,
  `CN_TIME` BIGINT NULL,
  INDEX `fk_TN_USER_ADMIRE_SPITTLE_LOG_TN_USER1_idx` (`CR_USER_ID` ASC),
  PRIMARY KEY (`CN_ID`),
  UNIQUE INDEX `CN_ID_UNIQUE` (`CN_ID` ASC),
  INDEX `fk_TN_USER_ADMIRE_SPITTLE_LOG_TN_SPITTLE1_idx` (`CR_SPITTLE_ID` ASC),
  CONSTRAINT `fk_TN_USER_ADMIRE_SPITTLE_LOG_TN_USER1`
    FOREIGN KEY (`CR_USER_ID`)
    REFERENCES `fad`.`TN_USER` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TN_USER_ADMIRE_SPITTLE_LOG_TN_SPITTLE1`
    FOREIGN KEY (`CR_SPITTLE_ID`)
    REFERENCES `fad`.`TN_SPITTLE` (`CN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = '用户点赞文章日志';


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
